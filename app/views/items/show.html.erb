<div class = "container">
  <div class = "row">
    <div class = "container row mx-auto mb-3">
      <div class="col-1">
        <%= link_to "←", items_path %>
      </div>
      
      <div class="col-2">
        <h3>No.<%= @item.no %></h3>
      </div>
      
      <div class = "col-1">
        <h3>A</h3>
      </div>
      
      <div class = "col-3">
        <h3><%= @item.name %></h3>
      </div>
      
      <div class = "col-3">
        <h3><%= rarity_on_star(@item.rarity) %></h3>
        
      </div>
      
      <div class = "col-2">
        <small>更新日:<%= l @item.updated_at %></small>
      </div>
    </div>
    
    <div class = "row mx-auto">
      <div class = "col-5">
        <%= image_tag "/images/goods.png", class: "img-thumbnail"%>
        
        <% if user_signed_in? %>
          <% if current_user.already_liked?(@item) %>
            <%= link_to item_likes_path(@item), method: :delete, class: "btn text-favorite w-100 mt-3" do %>
              <i class="fa fa-heart"></i><%= @item.likes.count %>
            <% end %>
          <% else %>
            <%= link_to item_likes_path(@item), method: :post, class: "btn text-favorite w-100 mt-3" do %>
              <i class="fa fa-heart"></i><%= @item.likes.count %>
            <% end %>
          <% end %>
        <% end %>
      
      </div>
      
      <div class = "col-7">
        <div class = " border rounded mb-3 py-2">
          <div class = "container row">
            <div class = "col-6">
              MajorCategory・Category
            </div>
            <div class = "col-6">
              重量<%= @item.weight %>
            </div>
          </div>
          
          <div class = "container row">
            <div class = "col-6">
              Lv.<%= @item.max_lvl %> / <%= @item.max_lvl %>
            </div>
            <div class = "col-6">
              親密度<%= @item.weight %> / <%= @item.weight %>
            </div>
          </div>
          
          <hr class = "weapon-hr">
          
          <div class = "container row">
            <div class = "col-6">
              攻撃力<%= @item.max_atck %>
            </div>
            <div class = "col-6">
              攻速<%= @item.max_spd %> / s
            </div>
          </div>
        
          <div class = "container row">
            <div class = "col-6">
              残弾数<%= @item.max_bullet %>
            </div>
          </div>
          
          <hr class = "weapon-hr">
          
          <div class = "container row">
            <div class = "col-6 border-end">
              進化前：<%= @item.before_evl %>
            </div>
            <div class = "col-6">
              進化後：<%= @item.after_evl %>
            </div>
          </div>
          
        </div>
        
        <div class = "container">
          <div class = "row border-bottom">
            <div class = "col-6">
              <%= @item.skl_one %>
            </div>
            
            <div class = "col-6">
              <%= @item.skl_one_element %>
            </div>
          </div>
          
          <div>
            <p class = "text-break"><%= @item.skl_one_detail %></p>
          </div>
        </div>
        
        <div class = "container">
          <div class = "row border-bottom">
            <div class = "col-6">
              <%= @item.skl_two %>
            </div>
            
            <div class = "col-6">
              <%= @item.skl_two_element %>
            </div>
          </div>
          
          <div>
            <p class = "text-break"><%= @item.skl_two_detail %></p>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <hr>
  
  <div class = "row">
    <h3 class = "col-6">Review</h3>
    
    <h3 class = "col-6">評価：3.5</h3>
  </div>
  
  <% if user_signed_in? %>
    <%= form_with model: @review, url: item_reviews_path(@item), class: "d-flex justify-content-end mt-3" do |f| %>
      <div class="btn mx-auto btn btn-danger" data-toggle="modal" data-target="#buy-confirm-modal">レビューを追加</div>
        <div class="modal fade" id="buy-confirm-modal" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">レビュー内容</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class = "modal-body text-center">
                <h4>評価</h4>
                <%= f.select :score, @star_repeat_select, {}, class: "form-control m-2 review-score-color" %>
                <h4>レビュー内容</h4>
                <%= f.text_area :content, class: "form-control m-2",  required: "", row: "5" %>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn border-dark text-dark" data-dismiss="modal">閉じる</button>
                <button type="submit" class="btn border-dark text-dark ">購入</button>
              </div>
            </div>
          </div>
        </div>
    <% end %>
  <% end %>
  
  <div class = "container">
    <% @sum = 0 %>
    <% @reviews.each do |review| %>
    <% @sum += review.score %>
    <div class="container">
      <div class="card my-2">
        <div class="card-header">
          <div class = "row">
            <%= review.user.nickname %>
            <label><%= l review.created_at %></label>
          </div>
        </div>
        <div class="card-body">
          <p class="card-text"><%= score_on_star(review.score) %></p>
          <p class="card-text"><%= review.content %></p>
        </div>
      </div>
    </div>
  <% end %>
  </div>

</div>
  
